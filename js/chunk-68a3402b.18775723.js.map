{"version":3,"sources":["webpack:///./src/views/publish/index.vue?2a27","webpack:///./src/views/publish/components/UpdateCover.vue?4cc1","webpack:///src/views/publish/components/UpdateCover.vue","webpack:///./src/views/publish/components/UpdateCover.vue?af9b","webpack:///./src/views/publish/components/UpdateCover.vue","webpack:///src/views/publish/index.vue","webpack:///./src/views/publish/index.vue?b24f","webpack:///./src/views/publish/index.vue","webpack:///./src/api/article.js","webpack:///./src/api/image.js","webpack:///./src/components/materialList.vue?419c","webpack:///./src/views/publish/index.vue?c21a","webpack:///./src/views/publish/components/UpdateCover.vue?5373","webpack:///./src/components/materialList.vue?e002","webpack:///src/components/materialList.vue","webpack:///./src/components/materialList.vue?848d","webpack:///./src/components/materialList.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","slot","switcher","on","goBack","directives","name","rawName","value","expression","ref","form","rules","model","callback","$$v","$set","extensions","cover","_v","type","_l","item","index","key","images","$event","onupdateCover","_e","channel","id","loading","onSubmit","_s","staticRenderFns","showDialog","Url","dialogVisible","activeName","uploadFile","onFileChange","confrimUpdate","props","components","MaterialList","data","imageUrl","methods","$refs","file","click","src","blob","created","component","UpdateCover","title","content","channel_id","channels","$router","go","validate","url","loadChannel","$route","query","loadArticle","computed","beforeRouteUpdate","from","resetFields","next","getArticleInfo","params","request","method","getArticleChannel","removeArticle","publishArticle","draft","editArticle","getArticleById","updateCommentStatus","commentStatus","article_id","allow_comment","uploadImg","getImg","deleteImg","collectImage","collect","collectChange","radio","nativeOn","image","select","staticStyle","isloading","is_collected","collectImg","deletImg","isSelectTool","total_count","pNum","onPageChange","uploadHeaders","uploadSuccess","isAddFun","isShowTool","Authorization","token","isActive","loadImage","$message","message"],"mappings":"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","file":"js/chunk-68a3402b.18775723.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-card',{staticClass:\"publish_content\"},[_c('div',{staticClass:\"clearfix\",attrs:{\"slot\":\"header\"},slot:\"header\"},[_c('el-page-header',{attrs:{\"content\":_vm.switcher + '文章'},on:{\"back\":_vm.goBack}})],1),_c('el-form',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loading),expression:\"loading\"}],ref:\"articleForm\",attrs:{\"model\":_vm.form,\"label-width\":\"80px\",\"rules\":_vm.rules}},[_c('el-form-item',{attrs:{\"label\":\"标题\",\"prop\":\"title\"}},[_c('el-input',{model:{value:(_vm.form.title),callback:function ($$v) {_vm.$set(_vm.form, \"title\", $$v)},expression:\"form.title\"}})],1),_c('el-form-item',{attrs:{\"label\":\"内容\",\"prop\":\"content\"}},[_c('el-tiptap',{attrs:{\"height\":\"500\",\"extensions\":_vm.extensions,\"placeholder\":\"请输入文章内容\"},model:{value:(_vm.form.content),callback:function ($$v) {_vm.$set(_vm.form, \"content\", $$v)},expression:\"form.content\"}})],1),_c('el-form-item',{attrs:{\"label\":\"封面\",\"prop\":\"cover.type\"}},[_c('el-radio-group',{model:{value:(_vm.form.cover.type),callback:function ($$v) {_vm.$set(_vm.form.cover, \"type\", $$v)},expression:\"form.cover.type\"}},[_c('el-radio',{attrs:{\"label\":1}},[_vm._v(\"单图\")]),_c('el-radio',{attrs:{\"label\":3}},[_vm._v(\"三图\")]),_c('el-radio',{attrs:{\"label\":0}},[_vm._v(\"无图\")]),_c('el-radio',{attrs:{\"label\":-1}},[_vm._v(\"自动\")])],1),(_vm.form.cover.type > 0)?[_c('div',{staticClass:\"cover_wrap\"},_vm._l((_vm.form.cover.type),function(item,index){return _c('update-cover',{key:index,staticClass:\"cover\",attrs:{\"imageUrl\":_vm.form.cover.images[index]},on:{\"updateCover\":function($event){return _vm.onupdateCover(index, $event)}}})}),1)]:_vm._e()],2),_c('el-form-item',{attrs:{\"label\":\"频道\",\"prop\":\"channel_id\"}},[_c('el-select',{attrs:{\"placeholder\":\"请选择\"},model:{value:(_vm.form.channel_id),callback:function ($$v) {_vm.$set(_vm.form, \"channel_id\", $$v)},expression:\"form.channel_id\"}},_vm._l((_vm.channels),function(channel,index){return _c('el-option',{key:index,attrs:{\"label\":channel.name,\"value\":channel.id}})}),1)],1),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"primary\",\"loading\":_vm.loading},on:{\"click\":function($event){return _vm.onSubmit(false)}}},[_vm._v(_vm._s(_vm.switcher))]),_c('el-button',{on:{\"click\":function($event){return _vm.onSubmit(true)}}},[_vm._v(\"存入草稿\")])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{staticClass:\"cover-container\",on:{\"click\":_vm.showDialog}},[(_vm.Url)?_c('img',{staticClass:\"cover-img\",attrs:{\"src\":_vm.Url,\"alt\":\"\"}}):_c('i',{staticClass:\"el-icon-plus\"})]),_c('el-dialog',{attrs:{\"title\":\"选择封面\",\"visible\":_vm.dialogVisible,\"width\":\"60%\",\"append-to-body\":\"\"},on:{\"update:visible\":function($event){_vm.dialogVisible=$event}}},[_c('el-tabs',{attrs:{\"type\":\"card\"},model:{value:(_vm.activeName),callback:function ($$v) {_vm.activeName=$$v},expression:\"activeName\"}},[_c('el-tab-pane',{attrs:{\"label\":\"素材库\",\"name\":\"first\"}},[_c('material-list',{ref:\"materList\",attrs:{\"isAddFun\":false,\"isShowTool\":false,\"isSelectTool\":true}})],1),_c('el-tab-pane',{attrs:{\"label\":\"上传图片\",\"name\":\"second\"}},[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.uploadFile}},[_vm._v(\"点击上传\")]),_c('input',{ref:\"file\",attrs:{\"type\":\"file\",\"id\":\"fileInput\",\"hidden\":\"\"},on:{\"change\":_vm.onFileChange}}),_c('div',{staticClass:\"image_wrap\"},[_c('img',{ref:\"preview-image\",attrs:{\"src\":\"\",\"alt\":\"\"}})])],1)],1),_c('span',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.dialogVisible = false}}},[_vm._v(\"取 消\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.confrimUpdate}},[_vm._v(\"确 定\")])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <div class=\"cover-container\" @click=\"showDialog\">\n      <img class=\"cover-img\" v-if=\"Url\" :src=\"Url\" alt=\"\" />\n      <i v-else class=\"el-icon-plus\"></i>\n    </div>\n    <el-dialog\n      title=\"选择封面\"\n      :visible.sync=\"dialogVisible\"\n      width=\"60%\"\n      append-to-body\n    >\n      <el-tabs v-model=\"activeName\" type=\"card\">\n        <el-tab-pane label=\"素材库\" name=\"first\">\n          <material-list\n            :isAddFun=\"false\"\n            :isShowTool=\"false\"\n            :isSelectTool=\"true\"\n            ref=\"materList\"\n          ></material-list>\n        </el-tab-pane>\n        <el-tab-pane label=\"上传图片\" name=\"second\">\n          <el-button type=\"primary\" @click=\"uploadFile\">点击上传</el-button>\n          <input\n            type=\"file\"\n            id=\"fileInput\"\n            hidden\n            ref=\"file\"\n            @change=\"onFileChange\"\n          />\n          <div class=\"image_wrap\">\n            <img src=\"\" alt=\"\" ref=\"preview-image\" />\n          </div>\n        </el-tab-pane>\n      </el-tabs>\n      <span slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"dialogVisible = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"confrimUpdate\">确 定</el-button>\n      </span>\n    </el-dialog>\n  </div>\n</template>\n<script>\nimport MaterialList from '@/components/materialList.vue'\nimport { uploadImg } from '@/api/image'\n\nexport default {\n  name: 'UpdateCover',\n  props: ['imageUrl'],\n  components: {\n    MaterialList\n  },\n  data() {\n    return {\n      dialogVisible: false,\n      activeName: 'second',\n      Url: this.imageUrl\n    }\n  },\n  methods: {\n    showDialog() {\n      this.dialogVisible = true\n    },\n    uploadFile() {\n      this.$refs.file.click()\n    },\n    onFileChange() {\n      const file = this.$refs.file.files[0]\n\n      const blob = URL.createObjectURL(file)\n      this.$refs['preview-image'].src = blob\n    },\n    async confrimUpdate() {\n      if (this.activeName === 'second') {\n        const file = this.$refs.file.files[0]\n        if (!file) {\n          this.$message({\n            type: 'warning',\n            message: '请选择文件'\n          })\n          return\n        }\n        const fd = new FormData()\n        fd.append('image', file)\n        const res = await uploadImg(fd)\n        this.dialogVisible = false\n        this.Url = res.data.data.url\n        this.$emit('updateCover', res.data.data.url)\n      } else if (this.activeName === 'first') {\n        const res = this.$refs['materList']\n        if (res.select === null) {\n          this.$message({\n            type: 'warning',\n            message: '请选择文件'\n          })\n          return\n        }\n        this.Url = res.images[res.select].url\n        this.$emit('updateCover', res.images[res.select].url)\n        this.dialogVisible = false\n      }\n    }\n  },\n  created() {}\n}\n</script>\n<style scoped lang=\"less\">\n.cover-container {\n  border: 1px dashed #d9d9d9;\n  width: 180px;\n  height: 180px;\n  cursor: pointer;\n  border-radius: 6px;\n  .cover-img {\n    width: 180px;\n    height: 180px;\n  }\n}\n.cover-container:hover {\n  border-color: #409eff;\n}\n.el-icon-plus {\n  font-size: 28px;\n  color: #8c939d;\n  width: 178px;\n  height: 178px;\n  line-height: 178px;\n  text-align: center;\n}\n.image_wrap {\n  margin: 20px;\n}\n</style>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UpdateCover.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UpdateCover.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./UpdateCover.vue?vue&type=template&id=1f66bfd9&scoped=true&\"\nimport script from \"./UpdateCover.vue?vue&type=script&lang=js&\"\nexport * from \"./UpdateCover.vue?vue&type=script&lang=js&\"\nimport style0 from \"./UpdateCover.vue?vue&type=style&index=0&id=1f66bfd9&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1f66bfd9\",\n  null\n  \n)\n\nexport default component.exports","<template>\n  <el-card class=\"publish_content\">\n    <div slot=\"header\" class=\"clearfix\">\n      <el-page-header @back=\"goBack\" :content=\"switcher + '文章'\">\n      </el-page-header>\n    </div>\n    <el-form\n      v-loading=\"loading\"\n      ref=\"articleForm\"\n      :model=\"form\"\n      label-width=\"80px\"\n      :rules=\"rules\"\n    >\n      <el-form-item label=\"标题\" prop=\"title\">\n        <el-input v-model=\"form.title\"></el-input>\n      </el-form-item>\n      <el-form-item label=\"内容\" prop=\"content\">\n        <el-tiptap\n          height=\"500\"\n          v-model=\"form.content\"\n          :extensions=\"extensions\"\n          placeholder=\"请输入文章内容\"\n        ></el-tiptap>\n      </el-form-item>\n      <el-form-item label=\"封面\" prop=\"cover.type\">\n        <el-radio-group v-model=\"form.cover.type\">\n          <el-radio :label=\"1\">单图</el-radio>\n          <el-radio :label=\"3\">三图</el-radio>\n          <el-radio :label=\"0\">无图</el-radio>\n          <el-radio :label=\"-1\">自动</el-radio>\n        </el-radio-group>\n        <template v-if=\"form.cover.type > 0\">\n          <div class=\"cover_wrap\">\n            <update-cover\n              :imageUrl=\"form.cover.images[index]\"\n              class=\"cover\"\n              v-for=\"(item, index) in form.cover.type\"\n              :key=\"index\"\n              @updateCover=\"onupdateCover(index, $event)\"\n            ></update-cover>\n          </div>\n        </template>\n      </el-form-item>\n      <el-form-item label=\"频道\" prop=\"channel_id\">\n        <el-select v-model=\"form.channel_id\" placeholder=\"请选择\">\n          <el-option\n            v-for=\"(channel, index) in channels\"\n            :key=\"index\"\n            :label=\"channel.name\"\n            :value=\"channel.id\"\n          ></el-option>\n        </el-select>\n      </el-form-item>\n      <el-form-item>\n        <el-button type=\"primary\" @click=\"onSubmit(false)\" :loading=\"loading\">{{\n          switcher\n        }}</el-button>\n        <el-button @click=\"onSubmit(true)\">存入草稿</el-button>\n      </el-form-item>\n    </el-form>\n  </el-card>\n</template>\n<script>\nimport UpdateCover from './components/UpdateCover'\nimport 'element-tiptap/lib/index.css'\nimport {\n  getArticleChannel,\n  publishArticle,\n  getArticleById,\n  editArticle\n} from '@/api/article'\nimport { uploadImg } from '@/api/image'\nimport {\n  // necessary extensions\n  ElementTiptap,\n  Doc,\n  Text,\n  Paragraph,\n  Heading,\n  Bold,\n  Underline,\n  Italic,\n  Strike,\n  ListItem,\n  BulletList,\n  OrderedList,\n  Image\n} from 'element-tiptap'\n\nexport default {\n  name: 'publish',\n  props: [],\n  components: {\n    'el-tiptap': ElementTiptap,\n    UpdateCover\n  },\n\n  data() {\n    return {\n      form: {\n        title: '',\n        content: '',\n        cover: {\n          images: [],\n          type: 0\n        },\n        channel_id: ''\n      },\n      rules: {\n        title: [\n          {\n            required: true,\n            message: '请输入标题名称',\n            trigger: 'blur'\n          },\n          {\n            min: 5,\n            max: 30,\n            message: '至少大于5个字符',\n            trigger: 'blur'\n          }\n        ],\n        'cover.type': [\n          {\n            required: true,\n            message: '请选择封面类型',\n            trigger: 'change'\n          }\n        ],\n        channel_id: [\n          {\n            required: true,\n            message: '请选择频道类型',\n            trigger: 'change'\n          }\n        ],\n        content: [\n          {\n            validator: (rule, value, callback) => {\n              if (value === '<p></p>') {\n                callback(new Error('内容不能为空'))\n              } else {\n                callback()\n              }\n            },\n            trigger: 'blur'\n          },\n          {\n            required: true,\n            message: '内容不能为空',\n            trigger: 'blur'\n          }\n        ]\n      },\n      channels: [],\n      loading: false,\n      extensions: [\n        new Doc(),\n        new Text(),\n        new Paragraph(),\n        new Heading({ level: 5 }),\n        new Bold({ bubble: true }), // render command-button in bubble menu.\n        new Underline({ bubble: true, menubar: false }), // render command-button in bubble menu but not in menubar.\n        new Italic(),\n        new Strike(),\n        new ListItem(),\n        new BulletList(),\n        new OrderedList(),\n        new Image({\n          async uploadRequest(file) {\n            const fd = new FormData()\n            fd.append('image', file)\n            const res = await uploadImg(fd)\n\n            return res.data.data.url\n          }\n        })\n      ]\n    }\n  },\n  methods: {\n    // 回退\n    goBack() {\n      this.$router.go(-1)\n    },\n    // 提交\n    onSubmit(draft) {\n      this.loading = true\n      this.$refs['articleForm'].validate(async valid => {\n        if (!valid) {\n          this.loading = false\n          return false\n        }\n        const id = this.$route.query.id\n        let res = null\n        if (id) {\n          res = await editArticle(id, this.form, draft)\n        } else {\n          res = await publishArticle(this.form, draft)\n        }\n\n        if (res.status === 201) {\n          this.$message({\n            message: `${draft ? '存入草稿草稿' : '发布或修改成功'} `,\n            type: `${draft ? 'info' : 'success'} `\n          })\n          this.$refs['articleForm'].resetFields()\n          this.$router.push('/article')\n        } else {\n          this.$message({\n            message: '操作失败',\n            type: 'error'\n          })\n        }\n        this.loading = false\n      })\n    },\n    // 加载频道\n    async loadChannel() {\n      const res = await getArticleChannel()\n      this.channels = res.data.data.channels\n    },\n    // 加载文章\n    async loadArticle() {\n      const id = this.$route.query.id\n      const res = await getArticleById(id)\n      this.form = res.data.data\n    },\n    // 接受图片url\n    onupdateCover(index, url) {\n      this.form.cover.images[index] = url\n    }\n  },\n  created() {\n    this.loadChannel()\n    if (this.$route.query.id) {\n      this.loadArticle()\n    }\n  },\n  computed: {\n    switcher() {\n      return this.$route.query.id ? '修改' : '发布'\n    }\n  },\n  beforeRouteUpdate(to, from, next) {\n    if (from.query.id) {\n      this.$refs['articleForm'].resetFields()\n      next()\n    } else {\n      next()\n    }\n  }\n}\n</script>\n<style scoped lang=\"less\">\n.cover_wrap {\n  display: flex;\n}\n.cover {\n  margin: 10px;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=69f9b932&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=69f9b932&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"69f9b932\",\n  null\n  \n)\n\nexport default component.exports","import request from '../util/request'\n// 获取文章\nexport function getArticleInfo(params) {\n  return request({\n    url: '/mp/v1_0/articles',\n    method: 'get',\n    params\n  })\n}\n// 获取文章频道\nexport function getArticleChannel() {\n  return request({\n    url: '/mp/v1_0/channels',\n    method: 'get'\n  })\n}\n// 删除文章\nexport function removeArticle(id) {\n  return request({\n    url: `/mp/v1_0/articles/${id}`,\n    method: 'DELETE'\n  })\n}\n// 发布文章\nexport function publishArticle(data, draft = false) {\n  return request({\n    url: '/mp/v1_0/articles',\n    method: 'post',\n    params: { draft: draft },\n    data\n  })\n}\n// 修改文章\nexport function editArticle(id, data, draft = false) {\n  return request({\n    url: `/mp/v1_0/articles/${id}`,\n    method: 'put',\n    params: { draft: draft },\n    data\n  })\n}\n// 获取指定文章\nexport function getArticleById(id) {\n  return request({\n    url: `/mp/v1_0/articles/${id}`,\n    method: 'get'\n  })\n}\n// 修改文章评论状态\nexport function updateCommentStatus(id, commentStatus) {\n  return request({\n    url: '/mp/v1_0/comments/status',\n    method: 'put',\n    params: {\n      article_id: id\n    },\n    data: {\n      allow_comment: commentStatus\n    }\n  })\n}\n","import request from '../util/request'\n\n// 上传图片\nexport function uploadImg(data) {\n  return request({\n    url: '/mp/v1_0/user/images',\n    method: 'post',\n    data\n  })\n}\n\n// 获取图片素材\nexport function getImg(params = {}) {\n  return request({\n    url: '/mp/v1_0/user/images',\n    params\n  })\n}\n\n// 删除图片素材\nexport function deleteImg(id) {\n  return request({\n    url: `/mp/v1_0/user/images/${id}`,\n    method: 'delete'\n  })\n}\n\n// 收藏图片\nexport function collectImage(id, collect) {\n  return request({\n    url: `/mp/v1_0/user/images/${id}`,\n    method: 'PUT',\n    data: {\n      collect\n    }\n  })\n}\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./materialList.vue?vue&type=style&index=0&id=6aa67e52&scoped=true&lang=less&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=69f9b932&scoped=true&lang=less&\"","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UpdateCover.vue?vue&type=style&index=0&id=1f66bfd9&scoped=true&lang=less&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{staticClass:\"switch_radio\"},[_c('el-radio-group',{on:{\"change\":_vm.collectChange},model:{value:(_vm.radio),callback:function ($$v) {_vm.radio=$$v},expression:\"radio\"}},[_c('el-radio-button',{attrs:{\"label\":false}},[_vm._v(\"全部\")]),_c('el-radio-button',{attrs:{\"label\":true}},[_vm._v(\"收藏\")])],1),(_vm.isAddFun)?_c('el-button',{attrs:{\"type\":\"success\"},nativeOn:{\"click\":function($event){_vm.dialogVisible = true}}},[_vm._v(\"添加素材\")]):_vm._e()],1),_c('el-divider'),_c('el-row',{attrs:{\"gutter\":20}},_vm._l((_vm.images),function(image,index){return _c('el-col',{key:image.id,attrs:{\"xs\":12,\"sm\":8,\"md\":6,\"lg\":4}},[_c('div',{staticClass:\"img_wrap\",on:{\"click\":function($event){_vm.select = index}}},[_c('el-image',{staticStyle:{\"height\":\"180px\"},attrs:{\"src\":image.url,\"fit\":\"cover \"}},[_c('div',{staticClass:\"image-slot\",attrs:{\"slot\":\"error\"},slot:\"error\"},[_c('i',{staticClass:\"el-icon-picture-outline\",staticStyle:{\"font-size\":\"20px\"}})])]),(_vm.isShowTool)?_c('div',{staticClass:\"img_tool\"},[_c('el-button',{attrs:{\"loading\":image.isloading,\"type\":\"warning\",\"icon\":image.is_collected ? 'el-icon-star-on' : 'el-icon-star-off',\"circle\":\"\",\"size\":\"mini\"},on:{\"click\":function($event){return _vm.collectImg(image)}}}),_c('el-button',{attrs:{\"type\":\"danger\",\"icon\":\"el-icon-delete\",\"circle\":\"\",\"size\":\"mini\"},on:{\"click\":function($event){return _vm.deletImg(image.id)}}})],1):_vm._e(),(_vm.isSelectTool && _vm.select === index)?_c('div',{staticClass:\"select_fun\"}):_vm._e()],1)])}),1),_c('el-pagination',{attrs:{\"background\":\"\",\"layout\":\"prev, pager, next\",\"total\":_vm.total_count,\"current-page\":_vm.pNum,\"page-size\":20},on:{\"current-change\":_vm.onPageChange,\"update:currentPage\":function($event){_vm.pNum=$event},\"update:current-page\":function($event){_vm.pNum=$event}}}),_c('el-dialog',{attrs:{\"title\":\"上传素材\",\"append-to-body\":true,\"visible\":_vm.dialogVisible,\"width\":\"50%\",\"center\":true},on:{\"update:visible\":function($event){_vm.dialogVisible=$event}}},[_c('el-upload',{attrs:{\"drag\":\"\",\"action\":\"http://api-toutiao-web.itheima.net/mp/v1_0/user/images\",\"multiple\":\"\",\"name\":\"image\",\"headers\":_vm.uploadHeaders,\"on-success\":_vm.uploadSuccess}},[_c('i',{staticClass:\"el-icon-upload\"}),_c('div',{staticClass:\"el-upload__text\"},[_vm._v(\"将文件拖到此处，或\"),_c('em',[_vm._v(\"点击上传\")])]),_c('div',{staticClass:\"el-upload__tip\",attrs:{\"slot\":\"tip\"},slot:\"tip\"},[_vm._v(\" 只能上传jpg/png文件，且不超过500kb \")])])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <div class=\"switch_radio\">\n      <el-radio-group v-model=\"radio\" @change=\"collectChange\">\n        <el-radio-button :label=\"false\">全部</el-radio-button>\n        <el-radio-button :label=\"true\">收藏</el-radio-button>\n      </el-radio-group>\n\n      <el-button\n        v-if=\"isAddFun\"\n        type=\"success\"\n        @click.native=\"dialogVisible = true\"\n        >添加素材</el-button\n      >\n    </div>\n    <el-divider></el-divider>\n    <el-row :gutter=\"20\">\n      <el-col\n        v-for=\"(image, index) in images\"\n        :key=\"image.id\"\n        :xs=\"12\"\n        :sm=\"8\"\n        :md=\"6\"\n        :lg=\"4\"\n      >\n        <div class=\"img_wrap\" @click=\"select = index\">\n          <el-image style=\" height: 180px\" :src=\"image.url\" fit=\"cover \">\n            <div slot=\"error\" class=\"image-slot\">\n              <i class=\"el-icon-picture-outline\" style=\"font-size:20px\"></i>\n            </div>\n          </el-image>\n          <div class=\"img_tool\" v-if=\"isShowTool\">\n            <!-- 收藏 -->\n            <el-button\n              :loading=\"image.isloading\"\n              type=\"warning\"\n              @click=\"collectImg(image)\"\n              :icon=\"\n                image.is_collected ? 'el-icon-star-on' : 'el-icon-star-off'\n              \"\n              circle\n              size=\"mini\"\n            ></el-button>\n            <!-- 删除 -->\n            <el-button\n              type=\"danger\"\n              icon=\"el-icon-delete\"\n              @click=\"deletImg(image.id)\"\n              circle\n              size=\"mini\"\n            ></el-button>\n          </div>\n          <div class=\"select_fun\" v-if=\"isSelectTool && select === index\"></div>\n        </div>\n      </el-col>\n    </el-row>\n    <el-pagination\n      @current-change=\"onPageChange\"\n      background\n      layout=\"prev, pager, next\"\n      :total=\"total_count\"\n      :current-page.sync=\"pNum\"\n      :page-size=\"20\"\n    >\n    </el-pagination>\n    <el-dialog\n      title=\"上传素材\"\n      :append-to-body=\"true\"\n      :visible.sync=\"dialogVisible\"\n      width=\"50%\"\n      :center=\"true\"\n    >\n      <el-upload\n        drag\n        action=\"http://api-toutiao-web.itheima.net/mp/v1_0/user/images\"\n        multiple\n        name=\"image\"\n        :headers=\"uploadHeaders\"\n        :on-success=\"uploadSuccess\"\n      >\n        <i class=\"el-icon-upload\"></i>\n        <div class=\"el-upload__text\">将文件拖到此处，或<em>点击上传</em></div>\n        <div class=\"el-upload__tip\" slot=\"tip\">\n          只能上传jpg/png文件，且不超过500kb\n        </div>\n      </el-upload>\n    </el-dialog>\n  </div>\n</template>\n<script>\nimport { getImg, deleteImg, collectImage } from '@/api/image'\nexport default {\n  name: 'MaterialList',\n  props: {\n    isAddFun: { Boolean, default: true },\n    isShowTool: { Boolean, default: true },\n    isSelectTool: { Boolean, default: false }\n  },\n  data() {\n    const { token } = JSON.parse(sessionStorage.getItem('user')) || ''\n    return {\n      radio: false,\n      images: [],\n      dialogVisible: false,\n      uploadHeaders: {\n        Authorization: 'Bearer ' + token\n      },\n      total_count: 0,\n      pNum: 1,\n      select: null,\n      isActive: true\n    }\n  },\n  methods: {\n    // 加载图片\n    async loadImage(page) {\n      if (page) {\n        this.pNum = page\n      }\n      const res = await getImg({\n        page: this.pNum,\n        collect: this.radio\n      })\n      this.total_count = res.data.data.total_count\n      const result = res.data.data.results\n      // 如果在实例创建之后添加新的属性到实例上，它不会触发视图更新\n      // 由于 Vue会在初始化实例时对属性执行 getter/setter 转化过程，\n      // 所以属性必须在 data 对象上存在才能让 Vue 转换它，这样才能让它是响应的\n      result.forEach(v => {\n        v.isloading = false\n      })\n      this.images = result\n    },\n    // 上传成功\n    uploadSuccess() {\n      this.dialogVisible = false\n      this.loadImage(this.pNum)\n      this.$message({\n        type: 'success',\n        message: '上传成功'\n      })\n    },\n    // 页数改变\n    onPageChange() {\n      this.loadImage()\n    },\n    // 切换收藏\n    collectChange() {\n      this.loadImage(1)\n    },\n    // 删除图片\n    async deletImg(id) {\n      const result = await this.$confirm(\n        '此操作将永久删除该图片, 是否继续?',\n        '删除提示',\n        {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        }\n      ).catch(err => err)\n      if (result === 'confirm') {\n        const res = await deleteImg(id)\n        if (res.status === 204) {\n          this.$notify({\n            title: '成功',\n            message: '删除成功',\n            type: 'success'\n          })\n        } else {\n          this.$notify({\n            title: '错误',\n            message: '删除失败',\n            type: 'error'\n          })\n        }\n        this.loadImage()\n      }\n    },\n    // 收藏图片\n    async collectImg(image) {\n      image.isloading = true\n      const collect = !image.is_collected\n      await collectImage(image.id, collect)\n      this.loadImage()\n      if (collect) {\n        this.$notify({\n          title: '成功',\n          message: '收藏成功',\n          type: 'success'\n        })\n      } else {\n        this.$notify({\n          title: '提示',\n          message: '取消收藏',\n          type: 'info'\n        })\n      }\n      image.isloading = false\n    }\n  },\n  created() {\n    this.loadImage()\n  }\n}\n</script>\n<style scoped lang=\"less\">\n.switch_radio {\n  padding-bottom: 20px;\n  display: flex;\n  justify-content: space-between;\n}\n.el-col {\n  margin-top: 10px;\n}\n/deep/ .el-dialog__body {\n  overflow: hidden;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.el-upload__tip {\n  text-align: center;\n}\n.el-row {\n  padding: 30px;\n}\n.img_wrap {\n  position: relative;\n  .img_tool {\n    display: flex;\n    justify-content: space-around;\n    align-items: center;\n    position: absolute;\n    bottom: 3px;\n    width: 100%;\n    height: 20%;\n    background-color: rgba(0, 0, 0, 0.3);\n  }\n}\n.select_fun {\n  background-image: url('./1.png');\n  position: absolute;\n  left: 0;\n  right: 0;\n  top: 0;\n  bottom: 0;\n  background-repeat: no-repeat;\n  background-size: cover;\n  opacity: 0.7;\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./materialList.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./materialList.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./materialList.vue?vue&type=template&id=6aa67e52&scoped=true&\"\nimport script from \"./materialList.vue?vue&type=script&lang=js&\"\nexport * from \"./materialList.vue?vue&type=script&lang=js&\"\nimport style0 from \"./materialList.vue?vue&type=style&index=0&id=6aa67e52&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"6aa67e52\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}